<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Web App</title>
  <style>
    body {
      margin: 0;
      font-family: "Space Grotesk", "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #f9f1e4, #f2e7d6 55%, #e9dcc9);
      color: #222222;
      min-height: 100vh;
      display: grid;
      place-items: center;
      padding: 32px 16px;
    }

    .page {
      width: min(420px, 100%);
      display: grid;
      gap: 16px;
    }

    .helper {
      font-size: 12px;
      color: #5c5c5c;
      margin: 0;
    }

    .row {
      display: grid;
      gap: 10px;
    }

    .inline {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      align-items: center;
    }
  </style>
</head>

<body>
  <div class="page" id="app"></div>
  <script type="module">
    import { startCountdown } from './node_modules/@monorepo/hello-world/dist/index.js';
    import { createButton, createCard, createInput } from './node_modules/@monorepo/web-ui/dist/index.js';

    const app = document.getElementById('app');
    const card = createCard({
      title: '用户注册',
      subtitle: '输入手机号，获取验证码后完成注册'
    });

    const body = card.querySelector('.web-ui-card__body');
    const phoneInput = createInput({ placeholder: '手机号', type: 'text' });
    const codeInput = createInput({ placeholder: '验证码', type: 'text' });
    const sendButton = createButton({ label: '发送验证码', variant: 'outline' });
    const submitButton = createButton({ label: '完成注册', variant: 'primary' });

    const helper = document.createElement('p');
    helper.className = 'helper';
    helper.textContent = '仅做演示，不会真的发送短信。';

    const row = document.createElement('div');
    row.className = 'row';
    row.append(phoneInput);

    const inline = document.createElement('div');
    inline.className = 'inline';
    inline.append(codeInput, sendButton);

    row.append(inline);
    row.append(submitButton);
    row.append(helper);

    body.append(row);
    app.append(card);

    let stopCountdown = null;

    sendButton.addEventListener('click', () => {
      const value = phoneInput.value.trim();
      if (!value) {
        sendButton.textContent = '请输入手机号';
        return;
      }

      if (stopCountdown) {
        return;
      }

      sendButton.disabled = true;
      sendButton.textContent = '已发送';

      stopCountdown = startCountdown({
        seconds: 60,
        onTick: (remaining) => {
          sendButton.textContent = remaining > 0 ? `重新发送 (${remaining}s)` : '重新发送';
        },
        onDone: () => {
          sendButton.disabled = false;
          stopCountdown = null;
        }
      });
    });
  </script>
</body>

</html>
